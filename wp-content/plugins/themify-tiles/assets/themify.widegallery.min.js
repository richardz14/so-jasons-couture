(function(a,n,p,r){function h(c,b){this.element=c;this.options=a.extend({},l,b);this._defaults=l;this.init()}var l={info:".twg-info",terms:".twg-terms",title:".twg-title",date:".twg-date",primaryAction:".twg-primary-action",actions:".twg-actions",speed:300,event:"click",ajax_url:"",ajax_action:"themify_get_gallery_entry",ajax_nonce:"",networkError:"",termSeparator:"",loader:'<div class="themify-loader"><div class="themify-loader_1 themify-loader_blockG"></div><div class="themify-loader_2 themify-loader_blockG"></div><div class="themify-loader_3 themify-loader_blockG"></div></div>'};
h.prototype={init:function(){a(this.element).hasClass("twg-gallery-shortcode")?this.galleryShortcode():this.galleryPostType();var c,b=this;a(n).resize(function(){clearTimeout(c);c=setTimeout(function(){b.doneResizing(a(b.element))},500)}).on("orientationchange",function(){b.doneResizing(a(b.element))})},galleryPostType:function(){var c=this,b=a(this.element),d=a(".twg-controls",this.element);a(".twg-holder",this.element);var e=a(".twg-loading",this.element);a("<img />").on("load",function(){var f=
a(".twg-link:first-child",d);e.html("").fadeOut();"undefined"!==typeof a.fn.backstretch?(b.backstretch(a(this).attr("src")),a(".backstretch",b).addClass("twg-deleteable").hide().fadeIn()):a(this).addClass("twg-deleteable").hide().prependTo(b).fadeIn();c.displayEntry(f.data("entry_id"))}).attr("src",a(".twg-link:first-child",d).data("image"));d.on(c.options.event,".twg-link",function(b){b.preventDefault();c.initEntryDisplay(a(this))})},initEntryDisplay:function(c){var b=this,d=a(this.element);a(".twg-holder",
this.element);var e=a(".twg-loading",this.element),f=c.data("image"),k=a("<img />");e.html(b.options.loader).fadeIn();k.on("load",function(){"undefined"!==typeof a.fn.backstretch?(d.backstretch(a(this).attr("src")),a(".backstretch",d).addClass("twg-behind")):a(this).addClass("twg-behind").prependTo(d);a(".twg-deleteable",d).fadeOut(b.options.speed,function(){a(".twg-behind",d).addClass("twg-deleteable").removeClass("twg-behind");a(this).remove();e.html("").fadeOut()});b.displayEntry(c.data("entry_id"))}).attr("src",
f)},displayEntry:function(c){var b=this,d=a(this.options.info,b.element),e=a(this.options.terms,b.element),f=a(this.options.title,b.element),k=a(this.options.date,b.element),q=a(this.options.primaryAction,b.element),h=a(this.options.actions,b.element),m=a(".twg-caption",this.element);d.fadeOut(b.options.speed);a.post(b.options.ajax_url,{action:b.options.ajax_action,nonce:b.options.ajax_nonce,entry_id:c},function(c,l){if("success"!=l)m.text(b.options.networkError).wrapInner('<div class="text-caption" />');
else{var g=jQuery.parseJSON(c);e.empty();a.each(g.terms,function(c,d){a('<a href="'+d.link+'">'+d.name+"</a>").appendTo(e);a('<span class="separator">'+b.options.termSeparator+"</span>").appendTo(e)});f.text(g.title).attr("href",g.link);k.text(g.date);m.empty();m.append(g.excerpt);""!=g.excerpt&&m.wrapInner('<div class="text-caption" />');q.attr("href",g.link);h.fadeIn();d.fadeIn(b.options.speed)}})},galleryShortcode:function(){var c=this,b=a(this.element),d=a(".twg-caption",this.element),e=a(".twg-controls",
this.element);a(".twg-holder",this.element);var f=a(".twg-loading",this.element);$img=a("<img />");$img.on("load",function(){f.html("").fadeOut();"undefined"!==typeof a.fn.backstretch?(b.backstretch(a(this).attr("src")),a(".backstretch",b).addClass("twg-deleteable").hide().fadeIn(c.options.speed,function(){d.text(a(".twg-link:first-child",e).data("description"));""!=d.text()&&d.wrapInner('<div class="text-caption" />')})):a(this).addClass("twg-deleteable").hide().prependTo(b).fadeIn(c.options.speed,
function(){d.text(a(".twg-link:first-child",e).data("description"));""!=d.text()&&d.wrapInner('<div class="text-caption" />')})}).attr("src",a(".twg-link:first-child",e).data("image"));e.on(c.options.event,".twg-link",function(b){b.preventDefault();c.initImageDisplay(a(this))})},initImageDisplay:function(c){var b=this,d=a(this.element),e=a(".twg-caption",this.element);a(".twg-holder",this.element);var f=a(".twg-loading",this.element),k=c.data("image"),h=a("<img />");f.html(b.options.loader).fadeIn();
h.on("load",function(){"undefined"!==typeof a.fn.backstretch?(d.backstretch(a(this).attr("src")),a(".backstretch",d).addClass("twg-behind")):a(this).addClass("twg-behind").prependTo(d);a(".twg-deleteable",d).fadeOut(b.options.speed,function(){a(".twg-behind",d).addClass("twg-deleteable").removeClass("twg-behind");a(this).remove();f.html("").fadeOut()});e.fadeOut(b.options.speed,function(){a(this).text(c.data("description")).fadeIn();""!=a(this).text()&&e.wrapInner('<div class="text-caption" />')})}).attr("src",
k)},doneResizing:function(c){"undefined"!==typeof a.fn.backstretch&&(c=c.data("backstretch"),"undefined"!==typeof c&&c.resize())},isTouchDevice:function(){try{return p.createEvent("TouchEvent"),!0}catch(c){return!1}}};a.fn.ThemifyWideGallery=function(c){return this.each(function(){var b=a.data(this,"ThemifyWideGallery");b||a.data(this,"ThemifyWideGallery",new h(this,c));if("undefined"!=typeof c.method&&"function"==typeof b[c.method])if("undefined"!=typeof c.element)b[c.method](c.element);else b[c.method]()})}})(jQuery,
window,document);
