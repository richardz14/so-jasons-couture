var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,g){a instanceof String&&(a=String(a));for(var c=a.length,d=0;d<c;d++){var b=a[d];if(e.call(g,b,d,a))return{i:d,v:b}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,g){a!=Array.prototype&&a!=Object.prototype&&(a[e]=g.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,g,c){if(e){g=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var d=a[c];d in g||(g[d]={});g=g[d]}a=a[a.length-1];c=g[a];e=e(c);e!=c&&null!=e&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,g){return $jscomp.findInternal(this,a,g).v}},"es6-impl","es3");var ThemifyTilesAdmin;
jQuery(function(a){var e=a("body"),g=null;ThemifyTilesAdmin={init:function(){ThemifyTilesAdmin.setupLightbox();ThemifyPageBuilder.openGallery();ThemifyPageBuilder.mediaUploader();e.on("click",".tf-tiles-add",ThemifyTilesAdmin.add_new_tile);e.on("click",".tf-tiles-save",ThemifyTilesAdmin.save_tiles);e.on("click","#tf-tiles-save-settings a",ThemifyTilesAdmin.preview_tile);e.on("click","#themify_tiles_lightbox_parent .close_lightbox",ThemifyTilesAdmin.closeLightboxCallback);e.on("dblclick","#themify_tiles_overlay",
ThemifyTilesAdmin.closeLightboxCallback);e.on("dblclick",".tf-tiles-editing .tf-tile .themify_builder_module_front_overlay",ThemifyTilesAdmin.edit_tile);e.on("click",".tf-tiles-editing .tf-tile .themify_module_options",ThemifyTilesAdmin.edit_tile);e.on("click",".tf-tiles-editing .tf-tile .themify_module_delete",ThemifyTilesAdmin.remove_tile);e.on("click",".tf-tiles-editing .tf-tile .themify_module_duplicate",ThemifyTilesAdmin.duplicate_tile);e.on("mouseenter",".tf-tiles-editing .tf-tile",ThemifyTilesAdmin.add_edit_edit_overlay);
e.on("mouseleave",".tf-tiles-editing .tf-tile",ThemifyTilesAdmin.remove_edit_overlay);e.on("click",".tfl-icon",function(c){a(this).addClass("selected").siblings().removeClass("selected");c.preventDefault()});a("<div/>",{id:"themify_builder_alert","class":"themify-builder-alert"}).appendTo("body").hide();ThemifyTilesAdmin.enable_editor()},add_edit_edit_overlay:function(){a(this).prepend('<div class="themify_builder_module_front_overlay" style="display: block;"></div><div class="module_menu_front"><ul class="themify_builder_dropdown_front" style="display: block;"><li class="themify_module_menu"><span class="ti-menu"></span><ul><li><a href="#" title="Edit" class="themify_module_options" data-module-name="box">Edit</a></li><li><a href="#" title="Duplicate" class="themify_module_duplicate">Duplicate</a></li><li><a href="#" title="Delete" class="themify_module_delete">Delete</a></li></ul></li></ul></div>')},
remove_edit_overlay:function(){a(this).find(".themify_builder_module_front_overlay, .module_menu_front").remove()},add_new_tile:function(){g=null;ThemifyTilesAdmin.openLightbox(a("#themify-tiles-settings").html(),function(){});return!1},remove_tile:function(c){c.preventDefault();a(this).closest(".tf-tile").remove()},duplicate_tile:function(c){g=null;c=a.parseJSON(ThemifyTilesAdmin.get_tile_data(a(this).closest(".tf-tile")));ThemifyTilesAdmin._add_tile(c);return!1},getDocHeight:function(){var a=window.document;
return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))},setupLightbox:function(){a('<div id="themify_tiles_lightbox_parent" class="themify_builder builder-lightbox themify_builder_admin clearfix "><h3 class="themify_builder_lightbox_title"></h3><a href="#" class="close_lightbox"><i class="ti ti-close"></i></a><div id="themify_tiles_lightbox_container"></div></div><div id="themify_tiles_overlay"></div>').hide().appendTo("body")},
setColorPicker:function(c){var d=ThemifyTilesAdmin;a(".minicolors-swatch",c).each(function(){var b=a(this),c=b.closest(".minicolors_wrapper");b.one("click",function(a){var b=c.find(".minicolors-input");c.prepend(b).find(".minicolors").remove();d.colorPickerInit(b);!a.isTrigger&&b.minicolors("show")}).prev(".minicolors-input").one("focusin",function(){a(this).next(".minicolors-swatch").trigger("click")});c.find(".color_opacity").one("change",function(){b.prev(".minicolors-input").attr("data-opacity",
a(this).val());b.trigger("click")});c.find(".minicolors-input").val()&&c.find(".color_opacity").trigger("change")})},colorPickerInit:function(c){var d=c.next(".color_opacity");c.prop("id");c.minicolors({opacity:1,changeDelay:200,beforeShow:function(){var b=a("#themify_tiles_lightbox_parent"),h=c.closest(".minicolors"),d=h.find(".minicolors-panel");b.offset().left+b.width()<=d.offset().left+d.width()?h.addClass("tb-minicolors-right"):h.removeClass("tb-minicolors-right")},change:function(b,c){if(!b||
c&&"0.99"==c)c=1;d.is(":focus")||d.attr("data-opacity",c).data("opacity",c).val(c);b&&a(this).minicolors("rgbaString")}});d.on("blur keyup",function(b){var d=parseFloat(a.trim(a(this).val()));if(1<d||isNaN(d)||""===d||0>d)d=c.val()?1:"","blur"===b.type&&a(this).val(d);a(this).attr("data-opacity",d);c.minicolors("opacity",d)}).trigger("blur")},openLightbox:function(c,d,b){var h=ThemifyTilesAdmin,f=a("#themify_tiles_lightbox_container");b=b||"";f.empty();a("#themify_tiles_overlay").show();a(document).scrollTop();
a(".themify_builder_lightbox_title").text(b);f.html(c);a("#themify_tiles_lightbox_parent").show();a("#themify_tiles_lightbox_container").height();c=a(window).height();a("#themify_tiles_lightbox_container .themify_builder_options_tab_content").css({maxHeight:.7*c});e.trigger("tf_tiles_edit_tile");a.isFunction(d)&&d.call(this);h.options_init()},closeLightboxCallback:function(a){a.preventDefault();ThemifyTilesAdmin.closeLightbox()},closeLightbox:function(){if(void 0!==tinyMCE)for(var c=tinymce.editors.length-
1;-1<c;c--)"content"!==tinymce.editors[c].id&&tinyMCE.execCommand("mceRemoveEditor",!0,tinymce.editors[c].id);a("#themify_tiles_overlay").hide();a("#themify_tiles_lightbox_parent").hide()},options_init:function(){ThemifyTilesAdmin.setColorPicker();a(".tb_tabs").tabs();a("#type_front a, #type_back a").click(function(){var c=a(this),d=c.attr("id");c.closest(".tb_tab").find("> .tf-tile-options").hide().filter(".tf-tile-options-"+d).show()});a(".tf-option-checkbox-enable input").click(function(){var c=
a(this).val();a(this).closest(".tb_tab").find(".tf-group-element").hide().filter(".tf-group-element-"+c).show()}).filter(":first-child").click();a(".themify-layout-icon").each(function(){var c=a(this).find("a").filter(".selected");1>c.length&&(c=a(this).find("a").filter(":first"));c.click()});a(".tb_lb_wp_editor").each(function(){var c=a(this).attr("id");ThemifyTilesAdmin.initQuickTags(c);"undefined"!==typeof tinyMCE&&ThemifyTilesAdmin.initNewEditor(c)})},initQuickTags:function(a){"function"===typeof window.parent.QTags&&
(window.parent.quicktags({id:a}),window.parent.QTags._buttonsInit())},initNewEditor:function(a){var c=tinyMCEPreInit.mceInit.tb_lb_hidden_editor;c.elements=a;c.selector="#"+a;return this.initMCEv4(a,c)},initMCEv4:function(a,d){if(3<parseInt(tinyMCE.majorVersion)){var b=new tinyMCE.Editor(a,d,tinyMCE.EditorManager);b.render();return b}},showLoader:function(c){"show"==c?a("#themify_builder_alert").addClass("busy").show():"spinhide"==c?a("#themify_builder_alert").delay(800).fadeOut(800,function(){a(this).removeClass("busy")}):
a("#themify_builder_alert").removeClass("busy").addClass("done").delay(800).fadeOut(800,function(){a(this).removeClass("done")})},retrieve_data:function(){var c={};a("#themify_tiles_lightbox_parent .tb_lb_option").each(function(d){d=a(this).attr("id");if(a(this).hasClass("tb_lb_wp_editor"))var b="undefined"!==typeof tinyMCE?void 0!==tinyMCE.editors[d]?tinyMCE.editors[d].getContent():a(this).val():a(this).val();else if(a(this).hasClass("themify-checkbox")){var h=[];a(this).find(".tb-checkbox:checked").each(function(b){h.push(a(this).val())});
b=0<h.length?h.join("|"):"|"}else if(a(this).hasClass("themify-layout-icon"))b=0<a(this).find(".selected").length?a(this).find(".selected").attr("id"):a(this).children().first().attr("id");else if(a(this).hasClass("themify-option-query-cat")){var f=a(this).parent();b=f.find(".query_category_single");f=f.find(".query_category_multiple");b=""!=f.val()?f.val()+"|multiple":b.val()+"|single"}else a(this).hasClass("tf-radio-input-container")?b=a(this).find('input[name="'+d+'"]:checked').val():a(this).hasClass("module-widget-form-container")?
b=a(this).find(":input").serializeObject():a(this).is("select, input, textarea")&&(b=a(this).val());b&&(c[d]=b)});return c},edit_tile:function(c){g=a(this).closest(".tf-tile");var d=JSON.parse(g.find(".tf-tile-data script").text());ThemifyTilesAdmin.openLightbox(a("#themify-tiles-settings").html(),function(){a("#themify_tiles_lightbox_parent .tb_lb_option").each(function(){var b=a(this);var c=b.attr("id");var f=d[c];if(f)if(b.hasClass("select_menu_field"))isNaN(f)?b.find("option[value='"+f+"']").attr("selected",
"selected"):b.find("option[data-termid='"+f+"']").attr("selected","selected");else if(b.is("select"))b.val(f);else if(b.hasClass("themify-builder-uploader-input"))c=a("<img/>",{src:f,width:50,height:50}),""!=f?(b.val(f),b.parent().find(".img-placeholder").empty().html(c)):b.parent().find(".thumb_preview").hide();else if(b.hasClass("themify-option-query-cat")){b=b.parent();b.find(".query_category_single");c=b.find(".query_category_multiple");var e=f.split("|")[0];c.val(e);b.find("option[value='"+e+
"']").attr("selected","selected")}else if(b.hasClass("themify_builder_row_js_wrapper")){c=0;0<f.length&&(c=f.length-1);for(e=0;e<c;e++)b.parent().find(".add_new a").first().trigger("click");b.find(".themify_builder_row").each(function(c){a(this).find(".tb_lb_option_child").each(function(b){b=a(this);var d=b.attr("id"),e=b.hasClass("tb_lb_wp_editor")?b.attr("name"):b.data("input-id"),e=f[c][""+e+""];if(b.hasClass("themify-builder-uploader-input")){var g=a("<img/>",{src:e,width:50,height:50});""!=e&&
void 0!=e?(b.val(e),b.parent().find(".img-placeholder").empty().html(g).parent().show()):b.parent().find(".thumb_preview").hide()}else b.hasClass("tf-radio-choice")?b.find("input[value='"+e+"']").attr("checked","checked"):b.is("input, textarea, select")&&b.val(e);b.hasClass("tb_lb_wp_editor")&&!b.hasClass("clone")&&(self.initQuickTags(d),"undefined"!==typeof tinyMCE&&self.initNewEditor(d))})})}else if(b.hasClass("tf-radio-input-container"))b.find("input[value='"+f+"']").attr("checked","checked"),
c=b.find('input[name="'+c+'"]:checked').val(),b.hasClass("tf-option-checkbox-enable")&&(a(".tf-group-element").hide(),a(".tf-group-element-"+c).show());else if(b.is("input, textarea"))b.val(f);else if(b.hasClass("themify-checkbox")){var g=f,g=g.split("|");b.find(".tb-checkbox").each(function(){-1<a.inArray(a(this).val(),g)?a(this).prop("checked",!0):a(this).prop("checked",!1)})}else b.hasClass("themify-layout-icon")?b.find("#"+f.trim()).addClass("selected"):b.html(f);else b.hasClass("themify-layout-icon")?
b.children().first().addClass("selected"):b.hasClass("themify-builder-uploader-input")?b.parent().find(".thumb_preview").hide():b.hasClass("tf-radio-input-container")?(b.find('input[type="radio"]').first().prop("checked"),c=b.find('input[name="'+c+'"]:checked').val(),b.hasClass("tf-option-checkbox-enable")&&(a(".tf-group-element").hide(),a(".tf-group-element-"+c).show())):b.hasClass("themify_builder_row_js_wrapper")?b.find(".themify_builder_row").each(function(b){a(this).find(".tb_lb_option_child").each(function(b){b=
a(this);var c=b.attr("id");b.hasClass("tb_lb_wp_editor")&&(b.data("input-id"),self.initQuickTags(c),"undefined"!==typeof tinyMCE&&self.initNewEditor(c))})}):b.hasClass("themify-checkbox")?b.find(".tb-checkbox").each(function(){a(this).prop("checked",!1)}):b.is("input, textarea")&&b.val("")})})},preview_tile:function(a){a.preventDefault();ThemifyTilesAdmin._add_tile(ThemifyTilesAdmin.retrieve_data())},_add_tile:function(c){a.ajax({type:"POST",url:ajaxurl,data:{action:"tf_preview_tile",tf_tile:c,tf_post_id:ThemifyTilesAdminVars.post_id,
tile_id:g?g.data("tile_id"):""},success:function(c){g?g.replaceWith(c):a("#themify-tiles").find(".tf-tiles-edit-wrap").append(c);ThemifyTilesAdmin.closeLightbox();e.trigger("tf_tiles_update");Themify_Tiles.init()}})},get_tile_data:function(a){return a.find(".tf-tile-data script").text()},save_tiles:function(c,d){c.preventDefault();var b=a(this),e=a(this).closest(".tf-tiles"),f=[];b.hasClass("saving")||(b.addClass("saving"),e.find(".tf-tiles-edit-wrap .tf-tile").each(function(){f.push(ThemifyTilesAdmin.get_tile_data(a(this)))}),
a.ajax({type:"POST",url:ajaxurl,data:{action:"tf_save_tiles",tf_post_id:e.data("post_id"),tf_data:f},success:function(c){b.removeClass("saving");"function"==typeof d&&d();a("#publish").click()}}))},enable_editor:function(){a(".tf-tiles-edit-wrap","#themify-tiles").sortable({placeholder:"themify_builder_ui_state_highlight",cursor:"move",handle:".themify_builder_module_front_overlay, .themify_builder_sub_row_top",connectWith:".tf-tile-edit-wrap",revert:100});e.trigger("tf_tiles_edit")}};ThemifyTilesAdmin.init()});
